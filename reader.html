<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Reader</title>

<style>
body {
  margin: 0;
  background: black;
}

img {
  display: block;
  width: 100vw;
  height: auto;
}
</style>
</head>
<body>

<div id="comic-container"></div>

<script>
(async function () {
  const params = new URLSearchParams(window.location.search);
  const comicKey = params.get("comic");
  const chapter = params.get("chapter");

  const container = document.getElementById("comic-container");

  if (!comicKey || !chapter) {
    container.innerHTML =
      "<p style='color:white;text-align:center;padding:50px;'>Brak parametru comic lub chapter.</p>";
    return;
  }

  try {
    const res = await fetch(`${comicKey}.json`);
    if (!res.ok) throw new Error("Nie znaleziono JSON");

    const data = await res.json();

    // chapters moÅ¼e mieÄ‡ klucze jako stringi
    const pages = data.chapters[String(chapter)];

    if (!pages || pages.length === 0) {
      container.innerHTML =
        "<p style='color:white;text-align:center;padding:50px;'>Brak obrazkÃ³w dla tego rozdziaÅ‚u.</p>";
      return;
    }

    pages.forEach(src => {
      const img = document.createElement("img");
      img.src = src;
      img.loading = "lazy"; // ðŸ”¥ duÅ¼y plus wydajnoÅ›ci
      container.appendChild(img);
    });

  } catch (err) {
    console.error(err);
    container.innerHTML =
      "<p style='color:white;text-align:center;padding:50px;'>BÅ‚Ä…d wczytywania pliku JSON.</p>";
